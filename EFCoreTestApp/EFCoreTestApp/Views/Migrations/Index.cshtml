@using EFCoreTestApp.Models
@model MigrationsManager
@{
    ViewBag.Title = "Migrations";
    Layout = "_Layout";
}

<div class="m-1 p-2">
    <form asp-action="Index" method="get" class="form-inline">
        <label class="m-1">Database Context:</label>
        <select name="context" class="form-control">
            @foreach(var name in Model.ContextNames)
            {
                <option selected = "@(name == ViewBag.Context)">@name</option>
            }
        </select>
        <button class="btn btn-primary m-1">Select</button>
    </form>
</div>

<table class="table table-sm table-striped m-2">
    <thead>
        <tr>
            <th>Migration Name</th>
        </tr>
    </thead>
    <tbody>
        @foreach(string n in Model.AllMigrations)
        {
            <tr>
                <td>@n</td>
                <td>@(Model.AppliedMigrations.Contains(n) ? "Applied" : "Pending")</td>
            </tr>
        }
    </tbody>
</table>

<div class="m-1 p-2">
    <form asp-action="Migrate" method="post" class="form-inline">
        <input type="hidden" name="context" value="@ViewBag.Context" />
        <label class="m-1">Migration:</label>
        <select name="migration" class="from-control">
            <option selected value="@Model.AllMigrations.Last()">All</option>
            @foreach(var m in Model.AllMigrations.Reverse())
            {
                <option>@m</option>
            }
            <option value="0">None</option>
        </select>
        <button class="btn btn-primary m-1">Migrate</button>
    </form>
</div>